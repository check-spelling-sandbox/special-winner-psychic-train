

<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml">

      <meta charset="utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1.0"></meta>
      <title>3.5.&nbsp;Poll Neo4j - Chapter&nbsp;3.&nbsp;Configuration</title>
      <link rel="stylesheet" type="text/css" href="../../docbook.css"></link>
      <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"></link>
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css"></link>
      <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,400italic,600,300italic"></link>
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.36.0/codemirror.min.css"></link>
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.36.0/theme/neo.min.css"></link>
      <link rel="stylesheet" type="text/css" href="../../css/extra.css"></link>
      <link rel="stylesheet" type="text/css" href="../../css/chunked-base.css"></link><script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js" type="text/javascript"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.36.0/codemirror.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.36.0/addon/runmode/runmode.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.36.0/mode/javascript/javascript.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.36.0/mode/shell/shell.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.36.0/mode/powershell/powershell.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.36.0/mode/python/python.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.36.0/mode/xml/xml.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.36.0/mode/clike/clike.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.36.0/mode/cypher/cypher.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.36.0/mode/properties/properties.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.36.0/mode/groovy/groovy.min.js" type="text/javascript"></script><script src="../../javascript/colorize.js" type="text/javascript"></script><script src="../../javascript/tabs-for-chunked.js" type="text/javascript"></script><script src="../../javascript/mp-nav.js" type="text/javascript"></script><script src="../../javascript/versionswitcher.js" type="text/javascript"></script><script src="../../javascript/version.js" type="text/javascript"></script><script src="https://s3-eu-west-1.amazonaws.com/alpha.neohq.net/docs/new-manual/assets/search.js" type="text/javascript"></script><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"></meta>
      <meta name="description" content="This section gives an example of how to poll Neo4j, in order to know when it is ready for requests after starting up."></meta>
      <link rel="prev" href="../../configuration/set-initial-password/" title="3.4. Set an initial password"></link>
      <link rel="next" href="../../configuration/usage-data-collector/" title="3.6. Usage Data Collector"></link>
      <link rel="shortcut icon" href="../../wp-content/themes/neo4jweb/favicon.ico"></link><script>
        $(document).ready(function() {
          CodeMirror.colorize();
          tabTheSource($('body'));
          var $header = $('header').first();
          $header.prepend(
            $('<a href="../../" id="logo"><img src="../../wp-content/themes/neo4jweb/assets/images/neo4j-logo-2015.png" alt="Neo4j Logo"></img></a>')
          );
          var $sidebar = $('<div id="sidebar-wrapper"></div>');
          $.get('toc.html', function (d){
            $(d).appendTo($sidebar);
            highlightToc();
            highlightLibraryHeader();
          });
          $sidebar.insertAfter($('header').first());
        });
        </script></head>
 
      <header>
         <div class="searchbox">
            <form id="search-form" class="search" name="search-form" role="search"><input id="search-form-input" name="q" title="search" type="search" lang="en" placeholder="Search Neo4j docs..." aria-label="Search Neo4j documentation" max-length="128" required="required"></input><input id="search-form-button" type="submit" value="Search"></input></form>
         </div>
         <ul class="documentation-library">
            <li><a href="../../">Operations Manual</a></li>
            <li><a href="../../docs/developer-manual/3.4/">Developer Manual</a></li>
            <li><a href="../../docs/ogm-manual/3.0/">OGM Manual</a></li>
            <li><a href="../../docs/graph-algorithms/3.4/">Graph Algorithms</a></li>
            <li><a href="../../docs/java-reference/3.4/">Java Reference</a></li>
         </ul>
         <nav id="header-nav"><span class="nav-previous"><a accesskey="p" href="../../configuration/set-initial-password/"><span class="fa fa-long-arrow-left" aria-hidden="true"></span>Set an initial password</a></span><span class="nav-current">
               <p class="nav-title hidden">3.5.&nbsp;Poll Neo4j</p></span><span class="nav-next"><a accesskey="n" href="../../configuration/usage-data-collector/">Usage Data Collector<span class="fa fa-long-arrow-right" aria-hidden="true"></span></a></span></nav>
      </header>
      <div id="search-results" class="hidden"></div>
      <section class="section" id="post-installation-wait-for-start">
         <div class="titlepage">
            <div>
               <div>
                  <h2 class="title" style="clear: both"><a class="anchor" href="#post-installation-wait-for-start"></a>3.5.&nbsp;Poll Neo4j
                  </h2>
               </div>
            </div>
         </div>
         <div class="abstract">
            <p>This section gives an example of how to poll Neo4j, in order to know when it is ready for requests after starting up.</p>
         </div>
         <p>After starting Neo4j it may take some time before the database is ready to serve requests.
            Systems that depend on the database should be able to retry if it is unavailable in order to cope with network glitches and
            other brief outages.
            To specifically wait for Neo4j to be available after starting, poll the Bolt or HTTP endpoint until it gives a successful
            response.
         </p>
         <p>The details of how to poll depend upon:</p>
         <div class="itemizedlist">
            <ul class="itemizedlist" style="list-style-type: disc; ">
               <li class="listitem">Whether the client uses HTTP or Bolt.</li>
               <li class="listitem">Whether encryption or authentication are enabled.</li>
            </ul>
         </div>
         <p>It is important to include a timeout in case Neo4j fails to start.
            Normally, ten seconds should be sufficient, but database recovery or upgrade may take much longer depending on the size of
            the store.
            If the instance is part of a cluster then the endpoint will not be available until other instances have started up, and the
            cluster has formed.
         </p>
         <p>Here is an example of polling (in Bash), using the HTTP endpoint with encryption and authentication disabled:</p><pre class="programlisting highlight"><code data-lang="shell">end="$((SECONDS+60))"
while true; do
    [[ "200" = "$(curl --silent --write-out %{http_code} --output /dev/null http://localhost:7474)" ]] &amp;&amp; break
    [[ "${SECONDS}" -ge "${end}" ]] &amp;&amp; exit 1
    sleep 1
done</code></pre><p>Using Bolt instead of HTTP, the example could look like this.</p><pre class="programlisting highlight"><code data-lang="shell">end="$((SECONDS+60))"
while true; do
    nc -w 2 localhost 7687 &amp;&amp; break
    [[ "${SECONDS}" -ge "${end}" ]] &amp;&amp; exit 1
    sleep 1
done</code></pre></section>
      <footer><script type="text/javascript">
        </script><script type="text/javascript">
        </script><script>;</script></footer>
   </body>
</html><!--
     FILE ARCHIVED ON 01:13:31 Apr 05, 2022 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 19:14:53 Jul 04, 2025.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
-->